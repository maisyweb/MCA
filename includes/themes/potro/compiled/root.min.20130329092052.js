(function(a){a.extend({scrollToTop:function(){var b=false;a("body").append(a("<a />").addClass("scroll-to-top").attr({href:"#",id:"scrollToTop"}).append(a("<i />").addClass("icon-chevron-up icon-white")));a("#scrollToTop").click(function(d){d.preventDefault();a("body, html").animate({scrollTop:0},500);return false});a(window).scroll(function(){if(!b){b=true;if(a(window).scrollTop()>150){a("#scrollToTop").stop(true,true).addClass("visible");b=false}else{a("#scrollToTop").stop(true,true).removeClass("visible");b=false}}})}})})(jQuery);(function(a){a.extend({browserSelector:function(){var m=navigator.userAgent,d=m.toLowerCase(),f=function(b){return d.indexOf(b)>-1},j="gecko",l="webkit",n="safari",e="opera",i=document.documentElement,k=[(!(/opera|webtv/i.test(d))&&/msie\s(\d)/.test(d))?("ie ie"+parseFloat(navigator.appVersion.split("MSIE")[1])):f("firefox/2")?j+" ff2":f("firefox/3.5")?j+" ff3 ff3_5":f("firefox/3")?j+" ff3":f("gecko/")?j:f("opera")?e+(/version\/(\d+)/.test(d)?" "+e+RegExp.jQuery1:(/opera(\s|\/)(\d+)/.test(d)?" "+e+RegExp.jQuery2:"")):f("konqueror")?"konqueror":f("chrome")?l+" chrome":f("iron")?l+" iron":f("applewebkit/")?l+" "+n+(/version\/(\d+)/.test(d)?" "+n+RegExp.jQuery1:""):f("mozilla/")?j:"",f("j2me")?"mobile":f("iphone")?"iphone":f("ipod")?"ipod":f("mac")?"mac":f("darwin")?"mac":f("webtv")?"webtv":f("win")?"win":f("freebsd")?"freebsd":(f("x11")||f("linux"))?"linux":"","js"];c=k.join(" ");i.className+=" "+c;a("html").addClass(c)}})})(jQuery);var Core={initialized:false,initialize:function(){if(this.initialized){return}this.initialized=true;this.build();this.events()},build:function(){$.browserSelector();$.scrollToTop();selectnav("mainMenu");this.stickyMenu();this.headerSearch();this.newsletter();this.featuredBoxes();this.flexSlider();$("a[rel=tooltip]").tooltip();this.sort();this.toggle();this.latestTweets();this.flickrFeed();this.fancybox()},events:function(){$(window).on("resize",function(){var a=window.setTimeout(function(){window.clearTimeout(a);Core.flexSlider();Core.featuredBoxes()},50)})},stickyMenu:function(){if($("body").hasClass("boxed")){return false}var a=$("body > header").height();var d=$("header .logo img");var c=this;var b=50;c.checkStickyMenu=function(){if($(window).scrollTop()>a+b&&$(window).width()>768){if($("body").hasClass("sticky-menu-active")){return false}$("body").addClass("sticky-menu-active");d.height(b).css("width","auto")}else{$("body").removeClass("sticky-menu-active");d.css("height","auto").css("width","auto")}};$(window).on("scroll",function(){c.checkStickyMenu()});$(window).on("resize",function(){c.checkStickyMenu()});c.checkStickyMenu();$("a[data-hash]").click(function(){var e=$(this.hash);if(e.get(0)){if(e.position().top>a+b&&$(window).width()>768){setTimeout(function(){$("html,body").scrollTop(e.offset().top-(100))},100)}}})},headerSearch:function(){$("#searchForm").validate({rules:{q:{required:true}},errorPlacement:function(a,b){},highlight:function(a){$(a).closest(".control-group").removeClass("success").addClass("error")},success:function(a){$(a).closest(".control-group").removeClass("error").addClass("success")}})},newsletter:function(){$("#newsletterForm").validate({submitHandler:function(a){$.ajax({type:"POST",url:$("#newsletterForm").attr("action"),data:{email:$("#newsletterForm #email").val()},dataType:"json",success:function(b){if(b.response=="success"){$("#newsletterSuccess").removeClass("hidden");$("#newsletterError").addClass("hidden");$("#newsletterForm #email").val("").blur().closest(".control-group").removeClass("success").removeClass("error")}else{$("#newsletterError").html(b.message);$("#newsletterError").removeClass("hidden");$("#newsletterSuccess").addClass("hidden");$("#newsletterForm #email").blur().closest(".control-group").removeClass("success").addClass("error")}}})},rules:{email:{required:true,email:true}},errorPlacement:function(a,b){},highlight:function(a){$(a).closest(".control-group").removeClass("success").addClass("error")},success:function(a){$(a).closest(".control-group").removeClass("error").addClass("success")}})},featuredBoxes:function(){$("div.featured-box").css("height","auto");$("div.featured-boxes").each(function(){var b=$(this);var a=0;$("div.featured-box",b).each(function(){if($(this).height()>a){a=$(this).height()}});$("div.featured-box",b).height(a)})},flexSlider:function(a){$("div.flexslider").each(function(){var b=$(this);var e={animationLoop:false,controlNav:true,directionNav:true};var d=$.extend({},e,a,b.data("plugin-options"));if(($(window).width()<768&&b.hasClass("normal-device"))||$(window).width()>768&&b.hasClass("small-device")||(!b.hasClass("flexslider-init"))){if(b.find("div.flex-viewport")&&typeof(d.maxVisibleItems)!="undefined"){var c=b;var g=c.clone();g.find("div.flex-viewport").children().unwrap();g.find("ul.flex-direction-nav, ol.flex-control-nav").remove().end().find("*").removeAttr("style").removeClass(function(i,l){return(l.match(/\bflex\S+/g)||[]).join(" ")});g.insertBefore(c);c.remove();b=g}if(typeof(d.maxVisibleItems)!="undefined"){b.find("ul.slides li > div").unwrap();var h=b.find("ul.slides").children("div");var k=d.maxVisibleItems;if($(window).width()<768){k=1;b.removeClass("normal-device").addClass("small-device")}else{b.removeClass("small-device").addClass("normal-device")}for(var f=0;f<h.length;f+=k){var j=h.slice(f,f+k);j.wrapAll("<li></li>")}}}b.flexslider(d).addClass("flexslider-init");if(d.controlNav){b.addClass("flexslider-control-nav")}if(d.directionNav){b.addClass("flexslider-direction-nav")}})},sort:function(){$("ul.sort-source").each(function(){var d=$(this);var a=$("ul.sort-destination[data-sort-id="+$(this).attr("data-sort-id")+"]");if(a.get(0)){var b=0;var c=$("span.thumb-info-caption p",a);c.each(function(){if($(this).height()>b){b=$(this).height()}});c.height(b);$(window).load(function(){a.isotope({itemSelector:"li",layoutMode:"fitRows"});d.find("a").click(function(g){g.preventDefault();var f=$(this);d.find("li.active").removeClass("active");$(this).parent().addClass("active");a.isotope({filter:f.parent().attr("data-option-value")});return false})})}})},toggle:function(){$("section.toggle label").prepend($("<i />").addClass("icon-plus"));$("section.toggle label").prepend($("<i />").addClass("icon-minus"));if($("html").hasClass("ie8")){$("section.toggle input").click(function(){$(this).parent().toggleClass("active")})}},fancybox:function(){$(".fancybox").fancybox()},flickrFeed:function(a){$("ul.flickr-feed").each(function(){var c=$(this);var d={limit:6,qstrings:{id:""},itemTemplate:'<li><a rel="flickr" href="{{image_b}}" class="fancybox"><span class="thumbnail"><img alt="{{title}}" src="{{image_s}}" /></span></a></li>'};var b=$.extend({},d,a,c.data("plugin-options"));c.jflickrfeed(b,function(e){$(".fancybox[rel=flickr]").fancybox()})})},latestTweets:function(){getTwitters("tweet",{id:"crivosthemes",count:1,enableLinks:true,ignoreReplies:true,clearContents:true,template:'<i class="icon-twitter"></i> "%text%" <a class="time" href="http://twitter.com/%user_screen_name%/statuses/%id_str%/">%time%</a>'})}};Core.initialize();